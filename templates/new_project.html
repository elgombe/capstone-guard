{% extends "base.html" %}
{% block title %}New Project - CapstoneGuard{% endblock %}

{% block content %}
<div style="max-width:1050px;margin:0 auto;padding:2rem 1.5rem;">

    <!-- Header -->
    <div class="page-header">
        <h1 class="page-title">Submit New Project</h1>
        <p class="page-subtitle">Fill in the details below. We'll check for similar projects automatically.</p>
    </div>

    <div style="display:grid;grid-template-columns:1fr 280px;gap:1.2rem;align-items:start;">

        <!-- Form -->
        <div class="oc-card">
            <div class="oc-card-body">
                <form method="POST" action="{{ url_for('projects.new_project') }}">

                    <div class="field">
                        <label class="oc-label" for="title">Project Title <span style="color:#e53e3e;">*</span></label>
                        <input type="text"
                               class="oc-input oc-input-lg"
                               id="title" name="title" required
                               placeholder="Enter a descriptive project title"
                               hx-post="{{ url_for('htmx_bp.htmx_check_duplicate') }}"
                               hx-trigger="keyup changed delay:1s"
                               hx-include="[name='description']"
                               hx-target="#duplicateCheck">
                    </div>

                    <div class="field" style="margin-top:1rem;">
                        <label class="oc-label" for="description">Project Description <span style="color:#e53e3e;">*</span></label>
                        <textarea class="oc-textarea"
                                  id="description" name="description"
                                  rows="7" required
                                  placeholder="Provide a detailed description including objectives, features, and technologies‚Ä¶"
                                  hx-post="{{ url_for('htmx_bp.htmx_check_duplicate') }}"
                                  hx-trigger="keyup changed delay:1s"
                                  hx-include="[name='title']"
                                  hx-target="#duplicateCheck"></textarea>
                        <p class="oc-help">Minimum 100 characters</p>
                    </div>

                    <!-- Duplicate check results -->
                    <div id="duplicateCheck"></div>

                    <div class="field" style="margin-top:1rem;">
                        <label class="oc-label" for="stream_id">Stream <span style="color:#e53e3e;">*</span></label>
                        <select class="oc-select" id="stream_id" name="stream_id" required>
                            <option value="">Select your stream</option>
                            {% for stream in streams %}
                            <option value="{{ stream.id }}">{{ stream.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="field" style="margin-top:1rem;">
                        <label class="oc-label" for="technologies">Technologies Used</label>
                        <input type="text" class="oc-input" id="technologies" name="technologies" placeholder="e.g., Python, Flask, PostgreSQL, React">
                        <p class="oc-help">Comma-separated list</p>
                    </div>

                    <div class="field" style="margin-top:1rem;">
                        <label class="oc-label" for="github_url">GitHub Repository URL</label>
                        <input type="url" class="oc-input" id="github_url" name="github_url" placeholder="https://github.com/username/repo">
                    </div>

                    <div class="field" style="margin-top:1rem;">
                        <label class="oc-label" for="demo_url">Demo / Live URL</label>
                        <input type="url" class="oc-input" id="demo_url" name="demo_url" placeholder="https://example.com">
                    </div>

                    <div style="display:flex;gap:0.75rem;margin-top:1.8rem;">
                        <a href="{{ url_for('dashboard.dash') }}" class="btn-oc btn-oc-outline">Cancel</a>
                        <button type="submit" class="btn-oc btn-oc-primary">Submit Project</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sidebar -->
        <div style="display:flex;flex-direction:column;gap:1rem;">
            {% for title, icon, items in [
                ('Submission Guidelines','üìã',['Ensure your title is clear and descriptive','Provide a detailed description (min 100 chars)','Check for similar projects first','All fields marked * are required']),
                ('Duplicate Detection','üîç',['System checks for similar projects automatically','You\'ll be notified if duplicates are found','You may still submit unique contributions']),
                ('What Happens Next?','‚úÖ',['Submit your project proposal','System checks for duplicates','Review panel evaluates your submission','You receive notification via email'])
            ] %}
            <div class="oc-card">
                <div class="oc-card-header">
                    <h3 class="oc-card-title" style="font-size:0.95rem;">{{ icon }} {{ title }}</h3>
                </div>
                <div class="oc-card-body" style="padding:1rem 1.2rem;">
                    <ul style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:0.55rem;">
                        {% for item in items %}
                        <li style="display:flex;align-items:flex-start;gap:8px;font-size:0.82rem;color:var(--text-muted);">
                            <span style="color:var(--green-primary);margin-top:1px;flex-shrink:0;">‚úì</span> {{ item }}
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            {% endfor %}
        </div>

    </div>
</div>

<style>
@media(max-width:900px){
    div[style*="grid-template-columns:1fr 280px"]{grid-template-columns:1fr !important;}
}
</style>
{% endblock %}
