{% if projects %}
    {% for project in projects %}
    <div class="oc-card" style="margin-bottom:0.75rem;">
        <div class="oc-card-body" style="display:flex;align-items:flex-start;gap:1.2rem;">
            <!-- Status indicator dot -->
            <div style="width:10px;height:10px;border-radius:50%;margin-top:6px;flex-shrink:0;
                background:{% if project.status.value == 'approved' %}var(--green-primary){% elif project.status.value == 'rejected' %}#e53e3e{% elif project.status.value == 'under_review' %}#3b82f6{% elif project.status.value == 'duplicate' %}#9333ea{% else %}#f59e0b{% endif %};">
            </div>
            <div style="flex:1;min-width:0;">
                <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:1rem;flex-wrap:wrap;">
                    <div style="min-width:0;">
                        <a href="{{ url_for('projects.project_detail', project_id=project.id) }}"
                           style="font-weight:700;font-size:1rem;color:var(--text-dark);text-decoration:none;display:block;margin-bottom:0.3rem;">
                            {{ project.title }}
                        </a>
                        <p style="font-size:0.85rem;color:var(--text-muted);margin-bottom:0.5rem;line-height:1.5;">
                            {{ project.description[:150] }}{% if project.description|length > 150 %}...{% endif %}
                        </p>
                        <div style="display:flex;align-items:center;gap:0.8rem;flex-wrap:wrap;">
                            <span style="font-size:0.78rem;color:var(--text-muted);">
                                <i class="bi bi-person"></i> {{ project.author.full_name }}
                            </span>
                            <span style="font-size:0.78rem;color:var(--text-muted);">
                                <i class="bi bi-calendar"></i> {{ project.submitted_at|timeago }}
                            </span>
                            <span class="tech-tag">{{ project.stream.name }}</span>
                        </div>
                    </div>
                    <div style="display:flex;flex-direction:column;align-items:flex-end;gap:0.6rem;flex-shrink:0;">
                        <span class="oc-badge badge-{{ project.status.value }}">{{ project.status.value|title }}</span>
                        <a href="{{ url_for('projects.project_detail', project_id=project.id) }}" class="btn-oc btn-oc-outline btn-oc-sm">
                            <i class="bi bi-eye"></i> View
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}

    <!-- Pagination -->
    {% if pagination.pages > 1 %}
    <div class="oc-pagination">
        {% if pagination.has_prev %}
        <a class="page-btn" href="#"
           hx-get="{{ url_for('htmx.htmx_projects', page=pagination.prev_num, stream=request.args.get('stream'), status=request.args.get('status'), search=request.args.get('search')) }}"
           hx-target="#projectsList">
            <i class="bi bi-chevron-left"></i>
        </a>
        {% endif %}

        {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
            {% if page_num %}
                <a class="page-btn {% if page_num == pagination.page %}active{% endif %}" href="#"
                   hx-get="{{ url_for('htmx.htmx_projects', page=page_num, stream=request.args.get('stream'), status=request.args.get('status'), search=request.args.get('search')) }}"
                   hx-target="#projectsList">{{ page_num }}</a>
            {% else %}
                <span class="page-btn disabled">â€¦</span>
            {% endif %}
        {% endfor %}

        {% if pagination.has_next %}
        <a class="page-btn" href="#"
           hx-get="{{ url_for('htmx.htmx_projects', page=pagination.next_num, stream=request.args.get('stream'), status=request.args.get('status'), search=request.args.get('search')) }}"
           hx-target="#projectsList">
            <i class="bi bi-chevron-right"></i>
        </a>
        {% endif %}
    </div>
    {% endif %}

{% else %}
    <div class="empty-state" style="background:var(--white);border:1px solid var(--border);border-radius:14px;">
        <div class="empty-icon">ðŸ“‚</div>
        <p class="empty-title">No Projects Found</p>
        <p class="empty-text">Try adjusting your filters or create a new project.</p>
        <a href="{{ url_for('projects.new_project') }}" class="btn-oc btn-oc-primary">New Project</a>
    </div>
{% endif %}
